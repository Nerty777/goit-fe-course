{"ast":null,"code":"import _toConsumableArray from \"/Users/nerty777/Desktop/work/goit-fe-course/react/homework-5/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/Users/nerty777/Desktop/work/goit-fe-course/react/homework-5/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/nerty777/Desktop/work/goit-fe-course/react/homework-5/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/nerty777/Desktop/work/goit-fe-course/react/homework-5/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/nerty777/Desktop/work/goit-fe-course/react/homework-5/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/nerty777/Desktop/work/goit-fe-course/react/homework-5/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/nerty777/Desktop/work/goit-fe-course/react/homework-5/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/nerty777/Desktop/work/goit-fe-course/react/homework-5/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/nerty777/Desktop/work/goit-fe-course/react/homework-5/client/src/modules/order-history/OrderHistoryContainer.js\";\nimport React, { Component } from 'react';\nimport * as API from '../../services/api';\nimport OrderHistoryEditor from './OrderHistoryEditor';\nimport ModalOrderHistory from '../../сomponents/Modal/ModalOrderHistory';\nimport OrderHistoryView from './OrderHistoryView';\nimport s from './OrderHistory.module.css';\nvar showMoreInfoCard = {};\n\nvar OrderHistoryContainer =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(OrderHistoryContainer, _Component);\n\n  function OrderHistoryContainer() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, OrderHistoryContainer);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(OrderHistoryContainer)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      orderHistoryList: [],\n      isModalOpen: false,\n      isLoading: false,\n      error: null\n    };\n\n    _this.handleDeleteCard =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(id) {\n        var isOk;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _this.setState({\n                  isLoading: true\n                });\n\n                _context.prev = 1;\n                _context.next = 4;\n                return API.deleteOrderHistoryItem(id);\n\n              case 4:\n                isOk = _context.sent;\n\n                if (isOk) {\n                  _context.next = 7;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 7:\n                _this.setState(function (state) {\n                  return {\n                    orderHistoryList: state.orderHistoryList.filter(function (item) {\n                      return item.id !== id;\n                    }),\n                    isLoading: false\n                  };\n                });\n\n                _context.next = 13;\n                break;\n\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](1);\n\n                _this.setState({\n                  error: _context.t0,\n                  isLoading: false\n                });\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[1, 10]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.onShowMoreInfo =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(id) {\n        var isOk;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _this.setState({\n                  isLoading: true\n                });\n\n                _context2.prev = 1;\n                _context2.next = 4;\n                return API.getOrderHistoryItemById(id);\n\n              case 4:\n                isOk = _context2.sent;\n\n                if (isOk) {\n                  _context2.next = 7;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 7:\n                showMoreInfoCard = isOk;\n                setTimeout(function () {\n                  _this.openModal();\n                }, 500);\n                _context2.next = 14;\n                break;\n\n              case 11:\n                _context2.prev = 11;\n                _context2.t0 = _context2[\"catch\"](1);\n\n                _this.setState({\n                  error: _context2.t0,\n                  isLoading: false\n                });\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[1, 11]]);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.handleAddNewOrderHistoryCard =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(address, rating, price) {\n        var date, year, month, dateNumber, newItemOrderHistory, newItem;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                date = new Date();\n                year = date.getFullYear();\n                month = date.getMonth() + 1;\n                dateNumber = date.getDate();\n                newItemOrderHistory = {\n                  date: \"\".concat(month, \"/\").concat(dateNumber, \"/\").concat(year),\n                  price: \"\".concat(price, \".00\"),\n                  address: \"\".concat(address),\n                  rating: \"\".concat(rating)\n                };\n\n                _this.setState({\n                  isLoading: true\n                });\n\n                _context3.prev = 6;\n                _context3.next = 9;\n                return API.addOrderHistoryItem(newItemOrderHistory);\n\n              case 9:\n                newItem = _context3.sent;\n\n                _this.setState(function (state) {\n                  return {\n                    orderHistoryList: [].concat(_toConsumableArray(state.orderHistoryList), [newItem]),\n                    isLoading: false\n                  };\n                });\n\n                _context3.next = 16;\n                break;\n\n              case 13:\n                _context3.prev = 13;\n                _context3.t0 = _context3[\"catch\"](6);\n\n                _this.setState({\n                  error: _context3.t0,\n                  isLoading: false\n                });\n\n              case 16:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[6, 13]]);\n      }));\n\n      return function (_x3, _x4, _x5) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.openModal = function () {\n      _this.setState({\n        isModalOpen: true,\n        isLoading: false\n      });\n    };\n\n    _this.closeModal = function () {\n      _this.setState({\n        isModalOpen: false\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(OrderHistoryContainer, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4() {\n        var orderHistoryList;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                this.setState({\n                  isLoading: true\n                });\n                _context4.prev = 1;\n                _context4.next = 4;\n                return API.getAllOrderHistory();\n\n              case 4:\n                orderHistoryList = _context4.sent;\n                this.setState({\n                  orderHistoryList: orderHistoryList,\n                  isLoading: false\n                });\n                _context4.next = 11;\n                break;\n\n              case 8:\n                _context4.prev = 8;\n                _context4.t0 = _context4[\"catch\"](1);\n                this.setState({\n                  error: _context4.t0,\n                  isLoading: false\n                });\n\n              case 11:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[1, 8]]);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          orderHistoryList = _this$state.orderHistoryList,\n          isModalOpen = _this$state.isModalOpen,\n          isLoading = _this$state.isLoading,\n          error = _this$state.error;\n      return React.createElement(\"section\", {\n        className: s.container,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, error && React.createElement(\"p\", {\n        className: s.red,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, error.message), isLoading && React.createElement(\"p\", {\n        className: s.loading,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }, \"Loading...\"), React.createElement(OrderHistoryView, {\n        orderHistoryList: orderHistoryList,\n        onShowMoreInfo: this.onShowMoreInfo,\n        handleDeleteCard: this.handleDeleteCard,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }), React.createElement(OrderHistoryEditor, {\n        onSubmit: this.handleAddNewOrderHistoryCard,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }), isModalOpen && React.createElement(ModalOrderHistory, {\n        onClose: this.closeModal,\n        text: showMoreInfoCard,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return OrderHistoryContainer;\n}(Component);\n\nexport { OrderHistoryContainer as default };","map":{"version":3,"sources":["/Users/nerty777/Desktop/work/goit-fe-course/react/homework-5/client/src/modules/order-history/OrderHistoryContainer.js"],"names":["React","Component","API","OrderHistoryEditor","ModalOrderHistory","OrderHistoryView","s","showMoreInfoCard","OrderHistoryContainer","state","orderHistoryList","isModalOpen","isLoading","error","handleDeleteCard","id","setState","deleteOrderHistoryItem","isOk","filter","item","onShowMoreInfo","getOrderHistoryItemById","setTimeout","openModal","handleAddNewOrderHistoryCard","address","rating","price","date","Date","year","getFullYear","month","getMonth","dateNumber","getDate","newItemOrderHistory","addOrderHistoryItem","newItem","closeModal","getAllOrderHistory","container","red","message","loading"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAO,KAAKC,GAAZ,MAAqB,oBAArB;AACA,OAAOC,kBAAP,MAA+B,sBAA/B;AACA,OAAOC,iBAAP,MAA8B,0CAA9B;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;AACA,OAAOC,CAAP,MAAc,2BAAd;AAEA,IAAIC,gBAAgB,GAAG,EAAvB;;IAEqBC,qB;;;;;;;;;;;;;;;;;UACnBC,K,GAAQ;AACNC,MAAAA,gBAAgB,EAAE,EADZ;AAENC,MAAAA,WAAW,EAAE,KAFP;AAGNC,MAAAA,SAAS,EAAE,KAHL;AAINC,MAAAA,KAAK,EAAE;AAJD,K;;UAoBRC,gB;;;;;+BAAmB,iBAAMC,EAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACjB,sBAAKC,QAAL,CAAc;AAAEJ,kBAAAA,SAAS,EAAE;AAAb,iBAAd;;AADiB;AAAA;AAAA,uBAGIV,GAAG,CAACe,sBAAJ,CAA2BF,EAA3B,CAHJ;;AAAA;AAGTG,gBAAAA,IAHS;;AAAA,oBAIVA,IAJU;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAKf,sBAAKF,QAAL,CAAc,UAAAP,KAAK;AAAA,yBAAK;AACtBC,oBAAAA,gBAAgB,EAAED,KAAK,CAACC,gBAAN,CAAuBS,MAAvB,CAA8B,UAAAC,IAAI;AAAA,6BAAIA,IAAI,CAACL,EAAL,KAAYA,EAAhB;AAAA,qBAAlC,CADI;AAEtBH,oBAAAA,SAAS,EAAE;AAFW,mBAAL;AAAA,iBAAnB;;AALe;AAAA;;AAAA;AAAA;AAAA;;AAUf,sBAAKI,QAAL,CAAc;AAAEH,kBAAAA,KAAK,aAAP;AAASD,kBAAAA,SAAS,EAAE;AAApB,iBAAd;;AAVe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;UAcnBS,c;;;;;+BAAiB,kBAAMN,EAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACf,sBAAKC,QAAL,CAAc;AAAEJ,kBAAAA,SAAS,EAAE;AAAb,iBAAd;;AADe;AAAA;AAAA,uBAGMV,GAAG,CAACoB,uBAAJ,CAA4BP,EAA5B,CAHN;;AAAA;AAGPG,gBAAAA,IAHO;;AAAA,oBAIRA,IAJQ;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAKbX,gBAAAA,gBAAgB,GAAGW,IAAnB;AACAK,gBAAAA,UAAU,CAAC,YAAM;AACf,wBAAKC,SAAL;AACD,iBAFS,EAEP,GAFO,CAAV;AANa;AAAA;;AAAA;AAAA;AAAA;;AAUb,sBAAKR,QAAL,CAAc;AAAEH,kBAAAA,KAAK,cAAP;AAASD,kBAAAA,SAAS,EAAE;AAApB,iBAAd;;AAVa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;UAcjBa,4B;;;;;+BAA+B,kBAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,KAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AACvBC,gBAAAA,IADuB,GAChB,IAAIC,IAAJ,EADgB;AAEvBC,gBAAAA,IAFuB,GAEhBF,IAAI,CAACG,WAAL,EAFgB;AAGvBC,gBAAAA,KAHuB,GAGfJ,IAAI,CAACK,QAAL,KAAkB,CAHH;AAIvBC,gBAAAA,UAJuB,GAIVN,IAAI,CAACO,OAAL,EAJU;AAKvBC,gBAAAA,mBALuB,GAKD;AAC1BR,kBAAAA,IAAI,YAAKI,KAAL,cAAcE,UAAd,cAA4BJ,IAA5B,CADsB;AAE1BH,kBAAAA,KAAK,YAAKA,KAAL,QAFqB;AAG1BF,kBAAAA,OAAO,YAAKA,OAAL,CAHmB;AAI1BC,kBAAAA,MAAM,YAAKA,MAAL;AAJoB,iBALC;;AAW7B,sBAAKX,QAAL,CAAc;AAAEJ,kBAAAA,SAAS,EAAE;AAAb,iBAAd;;AAX6B;AAAA;AAAA,uBAaLV,GAAG,CAACoC,mBAAJ,CAAwBD,mBAAxB,CAbK;;AAAA;AAarBE,gBAAAA,OAbqB;;AAc3B,sBAAKvB,QAAL,CAAc,UAAAP,KAAK;AAAA,yBAAK;AACtBC,oBAAAA,gBAAgB,+BAAMD,KAAK,CAACC,gBAAZ,IAA8B6B,OAA9B,EADM;AAEtB3B,oBAAAA,SAAS,EAAE;AAFW,mBAAL;AAAA,iBAAnB;;AAd2B;AAAA;;AAAA;AAAA;AAAA;;AAmB3B,sBAAKI,QAAL,CAAc;AAAEH,kBAAAA,KAAK,cAAP;AAASD,kBAAAA,SAAS,EAAE;AAApB,iBAAd;;AAnB2B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;UAuB/BY,S,GAAY,YAAM;AAChB,YAAKR,QAAL,CAAc;AACZL,QAAAA,WAAW,EAAE,IADD;AAEZC,QAAAA,SAAS,EAAE;AAFC,OAAd;AAID,K;;UAED4B,U,GAAa,YAAM;AACjB,YAAKxB,QAAL,CAAc;AACZL,QAAAA,WAAW,EAAE;AADD,OAAd;AAGD,K;;;;;;;;;;;;;;;;AA1EC,qBAAKK,QAAL,CAAc;AAAEJ,kBAAAA,SAAS,EAAE;AAAb,iBAAd;;;uBAEiCV,GAAG,CAACuC,kBAAJ,E;;;AAAzB/B,gBAAAA,gB;AACN,qBAAKM,QAAL,CAAc;AACZN,kBAAAA,gBAAgB,EAAhBA,gBADY;AAEZE,kBAAAA,SAAS,EAAE;AAFC,iBAAd;;;;;;;AAKA,qBAAKI,QAAL,CAAc;AAAEH,kBAAAA,KAAK,cAAP;AAASD,kBAAAA,SAAS,EAAE;AAApB,iBAAd;;;;;;;;;;;;;;;;;;6BAoEK;AAAA,wBACqD,KAAKH,KAD1D;AAAA,UACCC,gBADD,eACCA,gBADD;AAAA,UACmBC,WADnB,eACmBA,WADnB;AAAA,UACgCC,SADhC,eACgCA,SADhC;AAAA,UAC2CC,KAD3C,eAC2CA,KAD3C;AAEP,aACE;AAAS,QAAA,SAAS,EAAEP,CAAC,CAACoC,SAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG7B,KAAK,IAAI;AAAG,QAAA,SAAS,EAAEP,CAAC,CAACqC,GAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAsB9B,KAAK,CAAC+B,OAA5B,CADZ,EAEGhC,SAAS,IAAI;AAAG,QAAA,SAAS,EAAEN,CAAC,CAACuC,OAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFhB,EAGE,oBAAC,gBAAD;AACE,QAAA,gBAAgB,EAAEnC,gBADpB;AAEE,QAAA,cAAc,EAAE,KAAKW,cAFvB;AAGE,QAAA,gBAAgB,EAAE,KAAKP,gBAHzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHF,EAQE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QARF,EASE,oBAAC,kBAAD;AAAoB,QAAA,QAAQ,EAAE,KAAKW,4BAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QATF,EAUGd,WAAW,IACV,oBAAC,iBAAD;AACE,QAAA,OAAO,EAAE,KAAK6B,UADhB;AAEE,QAAA,IAAI,EAAEjC,gBAFR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAXJ,CADF;AAmBD;;;;EA1GgDN,S;;SAA9BO,qB","sourcesContent":["import React, { Component } from 'react';\nimport * as API from '../../services/api';\nimport OrderHistoryEditor from './OrderHistoryEditor';\nimport ModalOrderHistory from '../../сomponents/Modal/ModalOrderHistory';\nimport OrderHistoryView from './OrderHistoryView';\nimport s from './OrderHistory.module.css';\n\nlet showMoreInfoCard = {};\n\nexport default class OrderHistoryContainer extends Component {\n  state = {\n    orderHistoryList: [],\n    isModalOpen: false,\n    isLoading: false,\n    error: null,\n  };\n\n  async componentDidMount() {\n    this.setState({ isLoading: true });\n    try {\n      const orderHistoryList = await API.getAllOrderHistory();\n      this.setState({\n        orderHistoryList,\n        isLoading: false,\n      });\n    } catch (error) {\n      this.setState({ error, isLoading: false });\n    }\n  }\n\n  handleDeleteCard = async id => {\n    this.setState({ isLoading: true });\n    try {\n      const isOk = await API.deleteOrderHistoryItem(id);\n      if (!isOk) return;\n      this.setState(state => ({\n        orderHistoryList: state.orderHistoryList.filter(item => item.id !== id),\n        isLoading: false,\n      }));\n    } catch (error) {\n      this.setState({ error, isLoading: false });\n    }\n  };\n\n  onShowMoreInfo = async id => {\n    this.setState({ isLoading: true });\n    try {\n      const isOk = await API.getOrderHistoryItemById(id);\n      if (!isOk) return;\n      showMoreInfoCard = isOk;\n      setTimeout(() => {\n        this.openModal();\n      }, 500);\n    } catch (error) {\n      this.setState({ error, isLoading: false });\n    }\n  };\n\n  handleAddNewOrderHistoryCard = async (address, rating, price) => {\n    const date = new Date();\n    const year = date.getFullYear();\n    const month = date.getMonth() + 1;\n    const dateNumber = date.getDate();\n    const newItemOrderHistory = {\n      date: `${month}/${dateNumber}/${year}`,\n      price: `${price}.00`,\n      address: `${address}`,\n      rating: `${rating}`,\n    };\n    this.setState({ isLoading: true });\n    try {\n      const newItem = await API.addOrderHistoryItem(newItemOrderHistory);\n      this.setState(state => ({\n        orderHistoryList: [...state.orderHistoryList, newItem],\n        isLoading: false,\n      }));\n    } catch (error) {\n      this.setState({ error, isLoading: false });\n    }\n  };\n\n  openModal = () => {\n    this.setState({\n      isModalOpen: true,\n      isLoading: false,\n    });\n  };\n\n  closeModal = () => {\n    this.setState({\n      isModalOpen: false,\n    });\n  };\n\n  render() {\n    const { orderHistoryList, isModalOpen, isLoading, error } = this.state;\n    return (\n      <section className={s.container}>\n        {error && <p className={s.red}>{error.message}</p>}\n        {isLoading && <p className={s.loading}>Loading...</p>}\n        <OrderHistoryView\n          orderHistoryList={orderHistoryList}\n          onShowMoreInfo={this.onShowMoreInfo}\n          handleDeleteCard={this.handleDeleteCard}\n        />\n        <br />\n        <OrderHistoryEditor onSubmit={this.handleAddNewOrderHistoryCard} />\n        {isModalOpen && (\n          <ModalOrderHistory\n            onClose={this.closeModal}\n            text={showMoreInfoCard}\n          />\n        )}\n      </section>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}