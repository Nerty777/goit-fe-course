"use strict";var bookmarksList=[],bookmarks=document.querySelector(".bookmarks"),loader=document.querySelector(".loader"),modal=document.querySelector(".modal"),form=document.querySelector(".form"),source=document.querySelector("#template").innerHTML.trim(),template=Handlebars.compile(source),bookmarksFromLocalStorage=JSON.parse(localStorage.getItem("bookmarks"));function makeMarkup(e){var t=e.reduce(function(e,t){return e+template(t)},"");bookmarks.innerHTML=t}function handleButtonAddUrl(e){(e.preventDefault(),"FORM"===e.target.nodeName)&&(validateUrl(document.querySelector(".form__input").value),form.reset())}function validateUrl(e){/^(https?:\/\/)?([\da-zа-яё0-9\.:-]+)\.([a-zа-яё\.]{2,6})([\/\w \.\/_|?!%@=&#:-]*)*\/?$/gi.test(e)?linkpreview(e):modalError("Invalid url","img/invalid.svg","invalid url","2rem")}function modalError(e,t,o,r){modal.style.top="50%";var a=document.querySelector(".modal__text"),n=document.querySelector(".modal__icon");a.textContent=e,n.setAttribute("src",t),n.setAttribute("alt",o),n.style.width=r,n.style.height=r,setTimeout(function(){modal.style.top="-100%"},3e3)}function removeHidden(){bookmarks.style.opacity=.3,form.style.opacity=.3,loader.classList.remove("hidden")}function addHidden(){bookmarks.style.opacity=1,form.style.opacity=1,loader.classList.add("hidden")}function linkpreview(o){removeHidden(),axios.get("https://api.linkpreview.net/?key=".concat("5bb920a205cea06f38e7909709a72b521a4a9d1c05841","&q=").concat(o)).then(function(e){console.log("response: ",e),makeBookmarks(e.data)}).catch(function(e){if(console.log(e),"Request failed with status code 424"===e.message){var t=/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n?]+)/gim.exec(o);t=t[1],makeBookmarks({url:o,title:t})}})}function makeBookmarks(t){if(bookmarksList.filter(function(e){return e.url===t.url}).length)return addHidden(),void setTimeout(function(){modalError("This url is already set in bookmarks!","img/copy.svg","copy url","5rem")},100);bookmarksList.unshift(t),makeMarkup(bookmarksList),localStorage.setItem("bookmarks",JSON.stringify(bookmarksList)),addHidden()}bookmarksFromLocalStorage&&makeMarkup(bookmarksList=bookmarksFromLocalStorage),form.addEventListener("submit",handleButtonAddUrl);var deleteBtn=document.querySelector(".delete");function handleButtonDelete(e){var t=e.target;if("BUTTON"===t.nodeName){e.preventDefault();var o=t.parentNode.querySelector(".bookmark__link").textContent,r=bookmarksList.filter(function(e){return e.url!==o});makeMarkup(bookmarksList=r),localStorage.setItem("bookmarks",JSON.stringify(r))}}bookmarks.addEventListener("click",handleButtonDelete);